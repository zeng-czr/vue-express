{"remainingRequest":"C:\\Users\\ht\\Desktop\\vue-express\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\ht\\Desktop\\vue-express\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\Users\\ht\\Desktop\\vue-express\\src\\store\\modules\\permission.js","dependencies":[{"path":"C:\\Users\\ht\\Desktop\\vue-express\\src\\store\\modules\\permission.js","mtime":1696237456934},{"path":"C:\\Users\\ht\\Desktop\\vue-express\\babel.config.js","mtime":1696052669664},{"path":"C:\\Users\\ht\\Desktop\\vue-express\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1696052662415},{"path":"C:\\Users\\ht\\Desktop\\vue-express\\node_modules\\babel-loader\\lib\\index.js","mtime":1696052663280},{"path":"C:\\Users\\ht\\Desktop\\vue-express\\node_modules\\eslint-loader\\index.js","mtime":1696052662632}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCB7IGFzeW5jUm91dGVzLCBjb25zdGFudFJvdXRlcnMgfSBmcm9tICdAL3JvdXRlcic7CmZ1bmN0aW9uIGhhc1Blcm1pc3Npb24ocm9sZXMsIHJvdXRlKSB7CiAgaWYgKHJvdXRlLm1ldGEgJiYgcm91dGUubWV0YS5yb2xlcykgewogICAgY29uc29sZS5sb2cocm9sZXMuc29tZShyb2xlID0+IHJvdXRlLm1ldGEucm9sZXMuaW5jbHVkZXMocm9sZSkpKTsKICAgIHJldHVybiByb2xlcy5zb21lKHJvbGUgPT4gcm91dGUubWV0YS5yb2xlcy5pbmNsdWRlcyhyb2xlKSk7CiAgICAvLyByZXR1cm4gZmFsc2UKICB9IGVsc2UgewogICAgcmV0dXJuIHRydWU7CiAgfQp9Ci8vIOi/h+a7pOWKqOaAgei3r+eUsQpleHBvcnQgZnVuY3Rpb24gZmlsdGVyQXN5bmNSb3V0ZXMocm91dGVzLCByb2xlcykgewogIGNvbnN0IHJlcyA9IFtdOwogIHJvdXRlcy5mb3JFYWNoKHJvdXRlID0+IHsKICAgIGNvbnN0IHRtcCA9IHsKICAgICAgLi4ucm91dGUKICAgIH07CiAgICBpZiAoaGFzUGVybWlzc2lvbihyb2xlcywgdG1wKSkgewogICAgICBpZiAodG1wLmNoaWxkcmVuKSB7CiAgICAgICAgdG1wLmNoaWxkcmVuID0gZmlsdGVyQXN5bmNSb3V0ZXModG1wLmNoaWxkcmVuLCByb2xlcyk7CiAgICAgIH0KICAgICAgcmVzLnB1c2godG1wKTsKICAgIH0KICB9KTsKICByZXR1cm4gcmVzOwp9CmNvbnN0IHN0YXRlID0gewogIHJvdXRlczogW10sCiAgYWRkUm91dGVzOiBbXQp9Owpjb25zdCBtdXRhdGlvbnMgPSB7CiAgU0VUX1JPVVRFUzogKHN0YXRlLCByb3V0ZXMpID0+IHsKICAgIHN0YXRlLmFkZFJvdXRlcyA9IHJvdXRlczsKICAgIHN0YXRlLnJvdXRlcyA9IGNvbnN0YW50Um91dGVycy5jb25jYXQocm91dGVzKTsKICB9Cn07CmNvbnN0IGFjdGlvbnMgPSB7CiAgZ2VuZXJhdGVSb3V0ZXMoewogICAgY29tbWl0CiAgfSwgcm9sZXMpIHsKICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgbGV0IGFjY2Vzc2VkUm91dGVzOwogICAgICBpZiAocm9sZXMuaW5jbHVkZXMoJ2FkbWluJykpIHsKICAgICAgICBhY2Nlc3NlZFJvdXRlcyA9IGFzeW5jUm91dGVzIHx8IFtdOwogICAgICB9IGVsc2UgewogICAgICAgIGFjY2Vzc2VkUm91dGVzID0gZmlsdGVyQXN5bmNSb3V0ZXMoYXN5bmNSb3V0ZXMsIHJvbGVzKTsKICAgICAgfQogICAgICBjb25zb2xlLmxvZyhhY2Nlc3NlZFJvdXRlcyk7CiAgICAgIGNvbW1pdCgnU0VUX1JPVVRFUycsIGFjY2Vzc2VkUm91dGVzKTsKICAgICAgcmVzb2x2ZShhY2Nlc3NlZFJvdXRlcyk7CiAgICB9KTsKICB9Cn07CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lc3BhY2VkOiB0cnVlLAogIHN0YXRlLAogIG11dGF0aW9ucywKICBhY3Rpb25zCn07"},{"version":3,"names":["asyncRoutes","constantRouters","hasPermission","roles","route","meta","console","log","some","role","includes","filterAsyncRoutes","routes","res","forEach","tmp","children","push","state","addRoutes","mutations","SET_ROUTES","concat","actions","generateRoutes","commit","Promise","resolve","accessedRoutes","namespaced"],"sources":["C:/Users/ht/Desktop/vue-express/src/store/modules/permission.js"],"sourcesContent":["import { asyncRoutes, constantRouters } from '@/router'\r\n\r\n\r\nfunction hasPermission (roles, route) {\r\n  if (route.meta && route.meta.roles) {\r\n    console.log(roles.some(role => route.meta.roles.includes(role)))\r\n    return roles.some(role => route.meta.roles.includes(role))\r\n    // return false\r\n  }\r\n  else {\r\n    return true\r\n  }\r\n}\r\n// 过滤动态路由\r\nexport function filterAsyncRoutes (routes, roles) {\r\n  const res = []\r\n\r\n  routes.forEach(route => {\r\n    const tmp = { ...route }\r\n    if (hasPermission(roles, tmp)) {\r\n      if (tmp.children) {\r\n        tmp.children = filterAsyncRoutes(tmp.children, roles)\r\n      }\r\n      res.push(tmp)\r\n    }\r\n  })\r\n  return res\r\n}\r\nconst state = {\r\n  routes: [],\r\n  addRoutes: []\r\n}\r\nconst mutations = {\r\n  SET_ROUTES: (state, routes) => {\r\n    state.addRoutes = routes\r\n    state.routes = constantRouters.concat(routes)\r\n  }\r\n}\r\nconst actions = {\r\n  generateRoutes ({ commit }, roles) {\r\n    return new Promise(resolve => {\r\n      let accessedRoutes\r\n      if (roles.includes('admin')) {\r\n        accessedRoutes = asyncRoutes || []\r\n      } else {\r\n        accessedRoutes = filterAsyncRoutes(asyncRoutes, roles)\r\n      }\r\n      console.log(accessedRoutes)\r\n      commit('SET_ROUTES', accessedRoutes)\r\n      resolve(accessedRoutes)\r\n    })\r\n  }\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n}"],"mappings":";AAAA,SAASA,WAAW,EAAEC,eAAe,QAAQ,UAAU;AAGvD,SAASC,aAAaA,CAAEC,KAAK,EAAEC,KAAK,EAAE;EACpC,IAAIA,KAAK,CAACC,IAAI,IAAID,KAAK,CAACC,IAAI,CAACF,KAAK,EAAE;IAClCG,OAAO,CAACC,GAAG,CAACJ,KAAK,CAACK,IAAI,CAACC,IAAI,IAAIL,KAAK,CAACC,IAAI,CAACF,KAAK,CAACO,QAAQ,CAACD,IAAI,CAAC,CAAC,CAAC;IAChE,OAAON,KAAK,CAACK,IAAI,CAACC,IAAI,IAAIL,KAAK,CAACC,IAAI,CAACF,KAAK,CAACO,QAAQ,CAACD,IAAI,CAAC,CAAC;IAC1D;EACF,CAAC,MACI;IACH,OAAO,IAAI;EACb;AACF;AACA;AACA,OAAO,SAASE,iBAAiBA,CAAEC,MAAM,EAAET,KAAK,EAAE;EAChD,MAAMU,GAAG,GAAG,EAAE;EAEdD,MAAM,CAACE,OAAO,CAACV,KAAK,IAAI;IACtB,MAAMW,GAAG,GAAG;MAAE,GAAGX;IAAM,CAAC;IACxB,IAAIF,aAAa,CAACC,KAAK,EAAEY,GAAG,CAAC,EAAE;MAC7B,IAAIA,GAAG,CAACC,QAAQ,EAAE;QAChBD,GAAG,CAACC,QAAQ,GAAGL,iBAAiB,CAACI,GAAG,CAACC,QAAQ,EAAEb,KAAK,CAAC;MACvD;MACAU,GAAG,CAACI,IAAI,CAACF,GAAG,CAAC;IACf;EACF,CAAC,CAAC;EACF,OAAOF,GAAG;AACZ;AACA,MAAMK,KAAK,GAAG;EACZN,MAAM,EAAE,EAAE;EACVO,SAAS,EAAE;AACb,CAAC;AACD,MAAMC,SAAS,GAAG;EAChBC,UAAU,EAAEA,CAACH,KAAK,EAAEN,MAAM,KAAK;IAC7BM,KAAK,CAACC,SAAS,GAAGP,MAAM;IACxBM,KAAK,CAACN,MAAM,GAAGX,eAAe,CAACqB,MAAM,CAACV,MAAM,CAAC;EAC/C;AACF,CAAC;AACD,MAAMW,OAAO,GAAG;EACdC,cAAcA,CAAE;IAAEC;EAAO,CAAC,EAAEtB,KAAK,EAAE;IACjC,OAAO,IAAIuB,OAAO,CAACC,OAAO,IAAI;MAC5B,IAAIC,cAAc;MAClB,IAAIzB,KAAK,CAACO,QAAQ,CAAC,OAAO,CAAC,EAAE;QAC3BkB,cAAc,GAAG5B,WAAW,IAAI,EAAE;MACpC,CAAC,MAAM;QACL4B,cAAc,GAAGjB,iBAAiB,CAACX,WAAW,EAAEG,KAAK,CAAC;MACxD;MACAG,OAAO,CAACC,GAAG,CAACqB,cAAc,CAAC;MAC3BH,MAAM,CAAC,YAAY,EAAEG,cAAc,CAAC;MACpCD,OAAO,CAACC,cAAc,CAAC;IACzB,CAAC,CAAC;EACJ;AACF,CAAC;AAED,eAAe;EACbC,UAAU,EAAE,IAAI;EAChBX,KAAK;EACLE,SAAS;EACTG;AACF,CAAC"}]}