{"remainingRequest":"C:\\Users\\ht\\Desktop\\vue-express\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\ht\\Desktop\\vue-express\\src\\store\\modules\\user.js","dependencies":[{"path":"C:\\Users\\ht\\Desktop\\vue-express\\src\\store\\modules\\user.js","mtime":1696653615924},{"path":"C:\\Users\\ht\\Desktop\\vue-express\\babel.config.js","mtime":1696052669664},{"path":"C:\\Users\\ht\\Desktop\\vue-express\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1696052662415},{"path":"C:\\Users\\ht\\Desktop\\vue-express\\node_modules\\babel-loader\\lib\\index.js","mtime":1696052663280}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmVycm9yLmNhdXNlLmpzIjsKaW1wb3J0IHsgbG9naW4gfSBmcm9tICdAL2FwaS91c2VyLmpzJzsKaW1wb3J0IHsgc2V0VG9rZW4gfSBmcm9tICdAL3V0aWxzL2F1dGguanMnOwpjb25zdCBzdGF0ZSA9IHsKICBuYW1lOiAnJywKICB0b2tlbjogJycsCiAgYXZhdG9yOiAnJywKICByb2xlczogW10KfTsKY29uc3QgbXV0YXRpb25zID0gewogIFNFVF9OQU1FOiAoc3RhdGUsIG5hbWUpID0+IHsKICAgIHN0YXRlLm5hbWUgPSBuYW1lOwogIH0sCiAgU0VUX1RPS0VOOiAoc3RhdGUsIHRva2VuKSA9PiB7CiAgICBzdGF0ZS50b2tlbiA9IHRva2VuOwogIH0sCiAgU0VUX0FWQVRPUjogKHN0YXRlLCBhdmF0b3IpID0+IHsKICAgIHN0YXRlLmF2YXRvciA9IGF2YXRvcjsKICB9LAogIFNFVF9ST0xFUzogKHN0YXRlLCByb2xlKSA9PiB7CiAgICBzdGF0ZS5yb2xlcy5wdXNoKHJvbGUpOwogIH0KfTsKY29uc3QgYWN0aW9ucyA9IHsKICAvLyBsb2dpbgogIGxvZ2luKHsKICAgIGNvbW1pdAogIH0sIHVzZXJJbmZvKSB7CiAgICBjb25zdCB7CiAgICAgIHVzZXJuYW1lLAogICAgICBwYXNzd29yZAogICAgfSA9IHVzZXJJbmZvOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgbG9naW4oewogICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZS50cmltKCksCiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkCiAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2U7CiAgICAgICAgaWYgKGRhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgc2V0VG9rZW4oZGF0YVswXS50b2tlbik7CiAgICAgICAgICBjb21taXQoJ1NFVF9UT0tFTicsIGRhdGFbMF0udG9rZW4pOwogICAgICAgICAgY29tbWl0KCdTRVRfQVZBVE9SJywgZGF0YVswXS5hdmF0YXIpOwogICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VySW5mbycsIEpTT04uc3RyaW5naWZ5KGRhdGFbMF0pKTsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcigi6K+356Gu6K6k55So5oi35ZCN5ZKM5a+G56CB5ZCO5YaN5qyh55m75b2VIikpOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICBnZXRJbmZvKHsKICAgIGNvbW1pdAogIH0pIHsKICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgLy8gY29tbWl0KCdTRVRfUk9MRVMnLCBbJ2FkbWluJ10pCiAgICAgIC8vIHJlc29sdmUoWydhZG1pbiddKQogICAgICBsZXQgcm9sZUxpc3QgPSBbXTsKICAgICAgbG9naW4oewogICAgICAgIHVzZXJuYW1lOiAiYWRtaW4iLAogICAgICAgIHBhc3N3b3JkOiAiMTIzNDU2IgogICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2U7CiAgICAgICAgaWYgKGRhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7CiAgICAgICAgICBjb21taXQoJ1NFVF9ST0xFUycsIGRhdGFbMF0ucm9sZSk7CiAgICAgICAgICBjb21taXQoJ1NFVF9OQU1FJywgZGF0YVswXS5uYW1lKTsKICAgICAgICAgIGNvbW1pdCgnU0VUX0FWQVRPUicsIGRhdGFbMF0uYXZhdGFyKTsKICAgICAgICAgIHJlc29sdmUoZGF0YVswXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoIumHjeaWsOeZu+mZhuWQjuWcqOiuv+mXrueZu+W9lSIpKTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGUsCiAgbXV0YXRpb25zLAogIGFjdGlvbnMKfTs="},{"version":3,"names":["login","setToken","state","name","token","avator","roles","mutations","SET_NAME","SET_TOKEN","SET_AVATOR","SET_ROLES","role","push","actions","commit","userInfo","username","password","Promise","resolve","reject","trim","then","response","console","log","data","length","avatar","window","localStorage","setItem","JSON","stringify","Error","catch","error","getInfo","roleList","namespaced"],"sources":["C:/Users/ht/Desktop/vue-express/src/store/modules/user.js"],"sourcesContent":["import { login } from '@/api/user.js'\r\nimport { setToken } from '@/utils/auth.js'\r\nconst state = {\r\n  name: '',\r\n  token: '',\r\n  avator: '',\r\n  roles: []\r\n}\r\nconst mutations = {\r\n  SET_NAME: (state, name) => {\r\n    state.name = name\r\n  },\r\n  SET_TOKEN: (state, token) => {\r\n    state.token = token\r\n  },\r\n  SET_AVATOR: (state, avator) => {\r\n    state.avator = avator\r\n  },\r\n  SET_ROLES: (state, role) => {\r\n    state.roles.push(role)\r\n  },\r\n}\r\nconst actions = {\r\n  // login\r\n  login ({ commit }, userInfo) {\r\n    const { username, password } = userInfo\r\n    return new Promise((resolve, reject) => {\r\n      login({ username: username.trim(), password: password }).then(response => {\r\n        console.log(response)\r\n        const data = response\r\n        if (data.length > 0) {\r\n          setToken(data[0].token)\r\n          commit('SET_TOKEN', data[0].token)\r\n          commit('SET_AVATOR', data[0].avatar)\r\n          window.localStorage.setItem('userInfo', JSON.stringify(data[0]))\r\n          resolve()\r\n        }\r\n        else {\r\n          reject(new Error(\"请确认用户名和密码后再次登录\"))\r\n        }\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n  getInfo ({ commit }) {\r\n    return new Promise((resolve) => {\r\n      // commit('SET_ROLES', ['admin'])\r\n      // resolve(['admin'])\r\n      let roleList = []\r\n      login({ username: \"admin\", password: \"123456\" }).then(response => {\r\n        const data = response\r\n        if (data.length > 0) {\r\n          console.log(data)\r\n          commit('SET_ROLES', data[0].role)\r\n          commit('SET_NAME', data[0].name)\r\n          commit('SET_AVATOR', data[0].avatar)\r\n          resolve(data[0])\r\n        }\r\n        else {\r\n          reject(new Error(\"重新登陆后在访问登录\"))\r\n        }\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  }\r\n}\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n}"],"mappings":"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"}]}